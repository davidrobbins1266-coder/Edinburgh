
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edinburgh Treasure Hunt (Bonham â†” Castle)</title>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --text:#f8fafc; --muted:#cbd5e1; --primary:#2563eb; --danger:#ef4444; --ok:#16a34a; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:linear-gradient(180deg,#0b1220,var(--bg));color:var(--text)}
    header{position:sticky;top:0;padding:14px 16px;background:#0b1220cc;border-bottom:1px solid #ffffff14;backdrop-filter:blur(6px)}
    .wrap{max-width:760px;margin:0 auto;padding:16px}
    .card{background:var(--panel);border:1px solid #ffffff14;border-radius:14px;padding:16px}
    h1{margin:0 0 6px;font-size:1.5rem}.subtitle{color:var(--muted);font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
    button{border:0;border-radius:12px;padding:10px 14px;font-weight:600;color:#fff;background:var(--primary);cursor:pointer}
    .btn-secondary{background:var(--danger)} .btn-ok{background:var(--ok)}
    .panel{margin-top:12px;background:#ffffff08;border:1px dashed #ffffff22;border-radius:12px;padding:12px}
    .progress{color:var(--muted);font-size:0.95rem}.clue{font-size:1.05rem;line-height:1.5}.hint{color:var(--muted);font-style:italic}
    .badge{display:inline-block;background:#2563eb33;color:#fff;padding:6px 10px;border-radius:999px;margin:4px 6px 0 0;font-size:0.85rem}
    .maplist a{display:block;color:#93c5fd;text-decoration:none;margin:6px 0}.maplist a:hover{text-decoration:underline}
    .footer{color:var(--muted);font-size:0.9rem;margin-top:18px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Edinburgh Treasure Hunt: Bonham â†” Castle</h1>
      <div class="subtitle">Family-friendly Â· ~1 hour each way Â· Clues unlock one by one</div>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <!-- Intro -->
      <section id="intro">
        <p>Start outside <strong>The Bonham Hotel</strong> (35 Drumsheugh Gardens). Tap <em>Start Hunt</em> to reveal the first clue. You can open map links directly from each clue.</p>
        <div class="controls">
          <button id="startBtn" type="button">Start Hunt</button>
          <button id="toggleTimer" type="button" class="btn-secondary">Timer: Off</button>
        </div>
        <div class="panel">
          <div><strong>Quick map links</strong> (for reference):</div>
          <div class="maplist">
            <a target="_blank" rel="noopener" href="https://wwwtel+EdinburghThe Bonham Hotel</a>
            https://www.google.com/maps/search/?q=St+Andrew+Square+EdinburghSt Andrew Square</a>
            <a target="_blank" rel/maps/search/?q=The+Balmoral+Hotel+Edinburgh+1+Princes+StreetThe Balmoral (clock tower)</a>
            https://www.google.com/maps/search/?q=St+Giles%27+Cathedral+EdinburghSt Gilesâ€™ Cathedral & Heart of Midlothian</a>
            https://www.google.com/maps/search/?q=Mercat+Cross+Edinburgh+High+StreetMercat Cross</a>
            <a target="_blank" rel="noopener" href="https://www.googleburgh Castle</a>
            <a target="_blank" rel="noopener" href="https://www.google.com/maps/search/?q=Floral+Clock+Princes+Street (Floral Clock)</a>
            https://www.google.com/maps/search/?q=Scott+Monument+EdinburghScott Monument</a>
            <a target="_blank" rel="noopener" href="https://www.google.com/maps/search/?q=Randolph+C         </div>
        </div>
      </section>

      <!-- Play -->
      <section id="play" hidden>
        <div class="progress">
          <span id="legLabel">Outbound to Castle</span> Â· Clue <span id="clueNum">1</span>/<span id="clueTotal">?</span> Â· <span class="timer" id="timer">60:00</span>
        </div>
        <div class="panel">
          <div class="clue" id="clueText"></div>
          <div class="hint" id="hintText"></div>
        </div>
        <div class="controls">
          <button id="hintBtn" type="button" class="btn-secondary">Show hint</button>
          <!-- Anchor prevents popup-blocking and ensures clickability -->
          #Open map</a>
          <button id="photoBtn" type="button" class="btn">Photo challenge</button>
          <button id="doneBtn" type="button" class="btn-ok">Mark as done</button>
        </div>
        <div class="panel" id="photoPanel" hidden>
          <div><strong>Photo challenge:</strong> snap what the clue asks, or check it off.</div>
          <div class="controls" style="margin-top:8px">
            <button id="photoDone" type="button" class="btn-ok">I took the photo</button>
            <button id="photoSkip" type="button" class="btn-secondary">Skip</button>
          </div>
        </div>
        <div class="panel">
          <div><strong>Badges</strong></div>
          <div id="badges"></div>
        </div>
      </section>

      <!-- Finish -->
      <section id="finish" hidden>
        <h2>ðŸŽ‰ Hunt complete!</h2>
        <p>You made it from The Bonham to Edinburgh Castle and back. Great exploring!</p>
        <div class="controls">
          <button id="restartBtn" type="button">Restart</button>
        </div>
      </section>

      <div class="footer">Tip: If crowds are heavy on the Royal Mile, use side lanes (Lady Stairâ€™s Close, Advocateâ€™s Close).</div>
    </div>
  </main>

  <script>
    // Ensure code runs after DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      const legs = {
        outbound: [
          { clue: "Begin where elegance meets calm...", hint: "Start at Drumsheugh Gardens by The Bonham; head toward Randolph Place/Randolph Crescent.", map: "https://www.google.com/maps/search/?q=The+Bonham+Hotel+Edinburgh", photo: "Group selfie at The Bonham sign." },
          { clue: "Seek the square that carries a saintâ€™s name...", hint: "St Andrew Square; look for Robert Louis Stevenson statue.", map: "https://www.google.com/maps/search/?q=St+Andrew+Square+Edinburgh", photo: "Photo of the statue or any book in the square." },
          { clue: "On George Street, find the palatial bank with a golden dome...", hint: "Royal Bank of Scotland buildingâ€”grand frontage with columns.", map: "https://www.google.com/maps/search/?q=St+Andrew+Square+Edinburgh", photo: "Snap the dome or the columns." },
          { clue: "Turn toward the princeâ€™s avenue and walk to the clock tower that rules New Year...", hint: "Princes Street to The Balmoral clock; Heart of Midlothian by St Gilesâ€™ Cathedral.", map: "https://www.google.com/maps/search/?q=The+Balmoral+Hotel+Edinburgh+1+Princes+Street", photo: "Photo of the heart mosaic." },
          { clue: "Near the heart stands a unicorn on the Mercat Cross...", hint: "Mercat Cross unicorn; head up the Royal Mile to Edinburgh Castle.", map: "https://www.google.com/maps/search/?q=Mercat+Cross+Edinburgh+High+Street", photo: "Photo with the unicorn or the Mercat Cross." },
          { clue: "Inside the castle, find Scotlandâ€™s smallest chapel...", hint: "St Margaretâ€™s Chapel.", map: "https://www.google.com/maps/search/?q=Edinburgh+Castle", photo: "Photo of the chapel exterior." }
        ],
        inbound: [
          { clue: "Leave the castle and stroll past tartan and whisky...", hint: "Plenty of kilt/tartan shop signs along the Royal Mile.", map: "https://www.google.com/maps/search/?q=Edinburgh+Castle", photo: "Photo of a tartan display." },
          { clue: "Descend to the gardens and find the floral clock...", hint: "Princes Street Gardensâ€™ Floral Clock near the west end.", map: "https://www.google.com/maps/search/?q=Floral+Clock+Princes+Street+Gardens+Edinburgh", photo: "Photo of the floral clock." },
          { clue: "A writer pierces the sky in gothic style...", hint: "Scott Monument by Princes Street.", map: "https://www.google.com/maps/search/?q=Scott+Monument+Edinburgh", photo: "Low-angle shot of the Scott Monument." },
          { clue: "Curve back through crescents to reach your elegant origin...", hint: "Randolph Crescent area back toward Drumsheugh Gardens and The Bonham.", map: "https://www.google.com/maps/search/?q=Randolph+Crescent+Edinburgh", photo: "Final group photo at The Bonham." }
        ]
      };

      const state = { leg: 'outbound', idx: 0, timerOn: false, secs: 60*60, badges: [] };

      // Shortcuts
      const $ = id => document.getElementById(id);
      const elIntro = $('intro'), elPlay = $('play'), elFinish = $('finish');
      const elClueText = $('clueText'), elHintText = $('hintText');
      const elHintBtn = $('hintBtn'), elDoneBtn = $('doneBtn');
      const elMapBtn = $('mapBtn'), elPhotoBtn = $('photoBtn');
      const elPhotoPanel = $('photoPanel'), elPhotoDone = $('photoDone'), elPhotoSkip = $('photoSkip');
      const elBadges = $('badges'), elClueNum = $('clueNum'), elClueTotal = $('clueTotal');
      const elLegLabel = $('legLabel'), elTimer = $('timer'), elToggleTimer = $('toggleTimer');

      function renderClue(){
        const legArr = legs[state.leg];
        const item = legArr[state.idx];
        elClueText.textContent = item.clue;
        elHintText.textContent = '';
        elClueNum.textContent = String(state.idx + 1);
        elClueTotal.textContent = String(legArr.length);
        elLegLabel.textContent = state.leg === 'outbound' ? 'Outbound to Castle' : 'Return to Bonham';
        elPhotoPanel.hidden = true;
        // Update the anchor href (clickable map link)
        elMapBtn.setAttribute('href', item.map);
      }
      function addBadge(text){
        const span = document.createElement('span');
        span.className = 'badge';
        span.textContent = text;
        elBadges.appendChild(span);
        state.badges.push(text);
      }
      function nextClue(){
        const legArr = legs[state.leg];
        if(state.idx < legArr.length - 1){
          state.idx += 1;
          renderClue();
        } else {
          if(state.leg === 'outbound'){
            addBadge('ðŸ° Castle reached');
            state.leg = 'inbound';
            state.idx = 0;
            state.secs = 60*60; // reset timer for inbound
            renderClue();
          } else {
            addBadge('âœ… Hunt complete');
            elPlay.hidden = true;
            elFinish.hidden = false;
          }
        }
      }
      let ticker;
      function formatSecs(s){ const m = Math.floor(s/60), ss = String(s%60).padStart(2,'0'); return `${String(m).padStart(2,'0')}:${ss}`; }
      function startTimer(){ clearInterval(ticker); ticker = setInterval(()=>{ if(!state.timerOn) return; state.secs = Math.max(0, state.secs-1); elTimer.textContent = formatSecs(state.secs); },1000); }

      // Wire events (after DOM ready)
      document.getElementById('startBtn').addEventListener('click', ()=>{
        elIntro.hidden = true; elPlay.hidden = false; elFinish.hidden = true;
        state.leg = 'outbound'; state.idx = 0; state.badges = []; state.secs = 60*60;
        renderClue(); startTimer();
      });
      document.getElementById('restartBtn')?.addEventListener('click', ()=>{ elFinish.hidden = true; elIntro.hidden = false; });
      elHintBtn.addEventListener('click', ()=>{ elHintText.textContent = legs[state.leg][state.idx].hint; });
      elPhotoBtn.addEventListener('click', ()=>{ const item = legs[state.leg][state.idx]; elPhotoPanel.hidden = false; elPhotoPanel.querySelector('div').innerHTML = `<strong>Photo challenge:</strong> ${item.photo}`; });
      elPhotoDone.addEventListener('click', ()=>{ addBadge('ðŸ“¸ Photo taken'); elPhotoPanel.hidden = true; });
      elPhotoSkip.addEventListener('click', ()=>{ elPhotoPanel.hidden = true; });
      elDoneBtn.addEventListener('click', ()=>{ addBadge('ðŸ§© Clue solved'); nextClue(); });
      elToggleTimer.addEventListener('click', ()=>{ state.timerOn = !state.timerOn; elToggleTimer.textContent = `Timer: ${state.timerOn ? 'On' : 'Off'}`; if(state.timerOn) startTimer(); });
           elTimer.textContent = formatSecs(state.secs);
    });
  </script>
</body>

